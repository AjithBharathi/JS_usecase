ğŸ”‘ Microtasks (a.k.a. job queue, microtask queue)

ğŸ‘‰ Run after the current execution stack completes, before macrotasks
ğŸ‘‰ They are high priority â€” they drain fully before moving to the next macrotask.

âœ… Examples of microtasks:

Promise.then, Promise.catch, Promise.finally
queueMicrotask (explicit microtask)
MutationObserver callbacks (browser)
process.nextTick (Node.js-specific, but it's actually even before other microtasks!)
ğŸ“ Microtasks are often used for continuations, so the app appears fast.

ğŸ”‘ Macrotasks (a.k.a. task queue, macro task queue)

ğŸ‘‰ Run after all microtasks have finished
ğŸ‘‰ Each macrotask is one full "tick" of the event loop.

âœ… Examples of macrotasks:

setTimeout
setInterval
setImmediate (Node.js)
requestAnimationFrame (browser â€” scheduled before paint)
I/O events (e.g. network responses, file reads)
UI rendering tasks
ğŸ“ Macrotasks schedule the "next phase" of execution â€” they're spaced out over time.

âš¡ Event Loop Order

1ï¸âƒ£ Run current sync code
2ï¸âƒ£ Run all microtasks queued during that sync code
3ï¸âƒ£ Run one macrotask (e.g. a timeout handler)
4ï¸âƒ£ Repeat!

ğŸ“ Visual summary

| Call Stack |
|------------|
| Sync code  |
--------------
| Microtask queue (drain all before next macrotask) |
| Promise.then / queueMicrotask / MutationObserver  |
--------------
| Macrotask queue (1 per loop) |
| setTimeout / setInterval / setImmediate / rAF    |
--------------



| Queue type | Examples                                                                  | Priority                                   |
| ---------- | ------------------------------------------------------------------------- | ------------------------------------------ |
| Microtask  | `Promise.then`, `queueMicrotask`, `MutationObserver`, `process.nextTick`  | Runs **after sync code, before macrotask** |
| Macrotask  | `setTimeout`, `setInterval`, `setImmediate`, `requestAnimationFrame`, I/O | Runs **after microtasks**                  |





 Is a normal callback function microtask or macrotask?

ğŸ‘‰ A normal callback function by itself does not belong to either queue.

â— What matters is who schedules that callback:

If you pass a callback to setTimeout, it becomes a macrotask.
If you pass a callback to Promise.then, it becomes a microtask.
If you pass a callback to queueMicrotask, itâ€™s a microtask.
If you pass a callback to requestAnimationFrame, itâ€™s scheduled for the browserâ€™s paint phase (macrotask-like).